---
import BaseLayout from '../layouts/BaseLayout.astro';
import GiftGuideCard from '../components/GiftGuideCard.astro';
import { getDailyContent, getDaysUntilChristmas, getLastUpdatedString } from '../lib/content-merger';

const dailyContent = await getDailyContent();
const daysUntilChristmas = getDaysUntilChristmas();
const lastUpdated = getLastUpdatedString(dailyContent);

// Featured guides with new visual product grids
const featuredGuides = [
  {
    title: "Gifts for Dad",
    description: "Practical, thoughtful gifts he'll actually use",
    href: "/gifts/for-dad",
    emoji: "ğŸ‘¨",
    itemCount: 8,
    badge: "NEW"
  },
  {
    title: "Gifts for Mom",
    description: "Heartfelt presents to show her you care",
    href: "/gifts/for-mom",
    emoji: "ğŸ‘©",
    itemCount: 10,
    badge: "NEW"
  },
  {
    title: "Tech Gifts",
    description: "Gadgets for the tech lover in your life",
    href: "/gifts/tech",
    emoji: "ğŸ“±",
    itemCount: 12,
    badge: "Popular"
  },
  {
    title: "Gifts Under $25",
    description: "Budget-friendly ideas that don't feel cheap",
    href: "/gifts/under-25",
    emoji: "ğŸ’µ",
    itemCount: 12,
    badge: "Best Value"
  },
];

const giftGuides = [
  {
    title: "Gifts for Him",
    description: "Top picks for boyfriends, husbands & brothers",
    href: "/guides/best-gifts-for-him",
    emoji: "ğŸ©",
    itemCount: 28
  },
  {
    title: "Gifts for Her",
    description: "Beautiful gifts for girlfriends, wives & sisters",
    href: "/guides/best-gifts-for-her",
    emoji: "ğŸ‘ ",
    itemCount: 32
  },
  {
    title: "Gifts for Kids",
    description: "Fun, educational toys they'll love",
    href: "/guides/best-toys-for-kids",
    emoji: "ğŸ§¸",
    itemCount: 35
  },
  {
    title: "Gifts for Teens",
    description: "Cool gifts that won't get an eye roll",
    href: "/guides/cool-gifts-for-teens",
    emoji: "ğŸ®",
    itemCount: 24
  },
  {
    title: "Gifts Under $50",
    description: "Great value picks for any recipient",
    href: "/guides/best-gifts-under-50",
    emoji: "ğŸ’°",
    itemCount: 45
  },
  {
    title: "White Elephant Gifts",
    description: "Hilarious crowd-pleasers for gift exchanges",
    href: "/guides/funny-white-elephant-gifts",
    emoji: "ğŸ˜",
    itemCount: 20
  },
  {
    title: "Stocking Stuffers",
    description: "Small but mighty gift ideas",
    href: "/guides/best-stocking-stuffers",
    emoji: "ğŸ§¦",
    itemCount: 50
  },
  {
    title: "Cozy Gifts",
    description: "Warm, comfort-focused presents",
    href: "/guides/cozy-christmas-gifts",
    emoji: "ğŸ§£",
    itemCount: 22
  }
];
---

<BaseLayout title="Find the Perfect Christmas Gift">
  <!-- Hero Section -->
  <section class="relative bg-gradient-to-br from-pine to-christmas-green text-white py-20 px-4">
    <div class="max-w-4xl mx-auto text-center">
      <!-- Christmas Countdown -->
      {daysUntilChristmas <= 30 && (
        <div class="inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full mb-6">
          <span class="text-2xl">ğŸ„</span>
          <span class="font-bold">
            {daysUntilChristmas === 0
              ? "Merry Christmas!"
              : daysUntilChristmas === 1
                ? "1 day until Christmas!"
                : `${daysUntilChristmas} days until Christmas!`}
          </span>
        </div>
      )}

      <h1 class="text-4xl md:text-6xl font-display font-bold mb-6">
        Find the Perfect Gift ğŸ
      </h1>
      <p class="text-xl md:text-2xl text-gray-200 mb-4 max-w-2xl mx-auto">
        {dailyContent.seasonalMessage}
      </p>

      <!-- Freshness Indicator -->
      <p class="text-sm text-gray-300 mb-8">
        <span class="inline-flex items-center gap-1">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          {lastUpdated}
        </span>
      </p>

      <div class="flex flex-wrap justify-center gap-4">
        <a href="#guides" class="btn-primary bg-christmas-red hover:bg-red-700">
          Browse Gift Guides
        </a>
        <a href="/budget-guides" class="btn-secondary bg-white/20 hover:bg-white/30">
          Shop by Budget
        </a>
      </div>
    </div>

    <!-- Decorative elements -->
    <div class="absolute bottom-0 left-0 right-0 h-16 bg-snow" style="clip-path: polygon(0 100%, 100% 100%, 100% 0, 0 100%)"></div>
  </section>
  
  <!-- Featured Guides with Product Images -->
  <section id="guides" class="max-w-7xl mx-auto px-4 py-16">
    <div class="flex items-center justify-center gap-2 mb-4">
      <span class="bg-christmas-red text-white text-xs font-bold px-2 py-1 rounded">NEW</span>
      <h2 class="text-3xl font-display font-bold text-pine text-center">
        Featured Gift Guides
      </h2>
    </div>
    <p class="text-gray-600 text-center mb-8 max-w-2xl mx-auto">
      Browse our upgraded guides with product images, prices, and easy filtering.
    </p>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-16">
      {featuredGuides.map(guide => (
        <a href={guide.href} class="group block bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 border-2 border-christmas-red/20 hover:border-christmas-red">
          <div class="relative h-32 bg-gradient-to-br from-christmas-green/10 to-christmas-red/10 flex items-center justify-center">
            <span class="text-5xl group-hover:scale-110 transition-transform duration-300">{guide.emoji}</span>
            {guide.badge && (
              <span class="absolute top-2 right-2 bg-christmas-red text-white text-xs font-bold px-2 py-1 rounded">
                {guide.badge}
              </span>
            )}
          </div>
          <div class="p-4">
            <h3 class="font-display font-bold text-lg text-pine mb-1 group-hover:text-christmas-red transition-colors">
              {guide.title}
            </h3>
            <p class="text-gray-600 text-sm mb-2">{guide.description}</p>
            <span class="text-xs text-christmas-green font-medium">
              {guide.itemCount} products with images â†’
            </span>
          </div>
        </a>
      ))}
    </div>

    <!-- More Gift Guides -->
    <h3 class="text-2xl font-display font-bold text-pine text-center mb-8">
      More Gift Guides
    </h3>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
      {giftGuides.map(guide => (
        <GiftGuideCard {...guide} />
      ))}
    </div>
  </section>
  
  <!-- Trust Section -->
  <section class="bg-gray-50 py-16 px-4">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-2xl font-display font-bold text-pine mb-8">
        Why Trust Our Recommendations?
      </h2>
      <div class="grid md:grid-cols-3 gap-8">
        <div>
          <span class="text-4xl mb-4 block">ğŸ”</span>
          <h3 class="font-bold text-lg mb-2">Carefully Curated</h3>
          <p class="text-gray-600 text-sm">Every product is hand-selected based on reviews, quality, and value.</p>
        </div>
        <div>
          <span class="text-4xl mb-4 block">â­</span>
          <h3 class="font-bold text-lg mb-2">Highly Rated</h3>
          <p class="text-gray-600 text-sm">We only recommend products with excellent customer reviews.</p>
        </div>
        <div>
          <span class="text-4xl mb-4 block">ğŸ’°</span>
          <h3 class="font-bold text-lg mb-2">Best Value</h3>
          <p class="text-gray-600 text-sm">Quality gifts at fair pricesâ€”no overpriced duds here.</p>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Final CTA -->
  <section class="max-w-4xl mx-auto px-4 py-16 text-center">
    <h2 class="text-2xl font-display font-bold text-pine mb-4">
      Ready to Find the Perfect Gift?
    </h2>
    <p class="text-gray-600 mb-6">
      Browse our curated guides organized by recipient, budget, or occasion.
    </p>
    <div class="flex flex-wrap justify-center gap-4">
      <a href="#guides" class="btn-primary">
        Browse All Guides
      </a>
      <a href="/budget-guides" class="btn-secondary">
        Shop by Budget
      </a>
    </div>
  </section>
</BaseLayout>
